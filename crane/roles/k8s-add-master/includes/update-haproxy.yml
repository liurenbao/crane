---

- name: Create Haproxy cfg Path
  file:
    path: "{{ haproxy_etc_dirs }}"
    mode: 0755
    owner: "{{ ssh_connect_user }}"
    state: directory

- name: Copy New Haproxy cfg Files
  template: 
    src: roles/kubernetes-manifests/templates/haproxy.cfg.j2
    dest: "{{ haproxy_etc_dirs }}haproxy.cfg"
    mode: 0644
    owner: "{{ ssh_connect_user }}"
    
- name: Restart Kubernetes Master HaProxy Containers
  shell: "{{ kubernetes_ctl_path }}docker rm -f $(docker ps --filter name=k8s_haproxy -q)"
  ignore_errors: true